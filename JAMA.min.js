"use strict";var Maths=function(){function t(){}return t.hypot=function(t,i){var s=Math.abs(t)>Math.abs(i)?(s=i/t,Math.abs(t)*Math.sqrt(1+s*s)):0!==i?(s=t/i,Math.abs(i)*Math.sqrt(1+s*s)):0;return s},t}();Maths.__class="Maths";var SingularValueDecomposition=function(){function t(t){void 0===this.U&&(this.U=null),void 0===this.V&&(this.V=null),void 0===this.s&&(this.s=null),void 0===this.m&&(this.m=0),void 0===this.n&&(this.n=0);var i=t.getArrayCopy();this.m=t.getRowDimension(),this.n=t.getColumnDimension();var r,n,s=Math.min(this.m,this.n);this.s=function(t){for(var i=[];0<t--;)i.push(0);return i}(Math.min(this.m+1,this.n)),this.U=(t=[this.m,s],(r=function(t){if(0===t.length)return 0;for(var i=[],s=0;s<t[0];s++)i.push(r(t.slice(1)));return i})(t)),this.V=(t=[this.n,this.n],(n=function(t){if(0===t.length)return 0;for(var i=[],s=0;s<t[0];s++)i.push(n(t.slice(1)));return i})(t));for(var h,o,e,a,f=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.n),u=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.m),l=Math.min(this.m-1,this.n),v=Math.max(0,Math.min(this.n-2,this.m)),c=0;c<Math.max(l,v);c++){if(c<l){this.s[c]=0;for(var p=c;p<this.m;p++)this.s[c]=Maths.hypot(this.s[c],i[p][c]);if(0!==this.s[c]){i[c][c]<0&&(this.s[c]=-this.s[c]);for(p=c;p<this.m;p++)i[p][c]/=this.s[c];i[c][c]+=1}this.s[c]=-this.s[c]}for(var m=c+1;m<this.n;m++){if(e=c<l,a=0!==this.s[c],e&&a){for(var g=0,p=c;p<this.m;p++)g+=i[p][c]*i[p][m];g=-g/i[c][c];for(p=c;p<this.m;p++)i[p][m]+=g*i[p][c]}f[m]=i[c][m]}if(c<l)for(p=c;p<this.m;p++)this.U[p][c]=i[p][c];if(c<v){f[c]=0;for(p=c+1;p<this.n;p++)f[c]=Maths.hypot(f[c],f[p]);if(0!==f[c]){f[c+1]<0&&(f[c]=-f[c]);for(p=c+1;p<this.n;p++)f[p]/=f[c];f[c+1]+=1}if(f[c]=-f[c],h=c+1<this.m,o=0!==f[c],h&&o){for(p=c+1;p<this.m;p++)u[p]=0;for(m=c+1;m<this.n;m++)for(p=c+1;p<this.m;p++)u[p]+=f[m]*i[p][m];for(m=c+1;m<this.n;m++)for(g=-f[m]/f[c+1],p=c+1;p<this.m;p++)i[p][m]+=g*u[p]}for(p=c+1;p<this.n;p++)this.V[p][c]=f[p]}}var d=Math.min(this.n,this.m+1);l<this.n&&(this.s[l]=i[l][l]),this.m<d&&(this.s[d-1]=0),v+1<d&&(f[v]=i[v][d-1]),f[d-1]=0;for(m=l;m<s;m++){for(p=0;p<this.m;p++)this.U[p][m]=0;this.U[m][m]=1}for(c=l-1;0<=c;c--)if(0!==this.s[c]){for(m=c+1;m<s;m++){for(g=0,p=c;p<this.m;p++)g+=this.U[p][c]*this.U[p][m];g=-g/this.U[c][c];for(p=c;p<this.m;p++)this.U[p][m]+=g*this.U[p][c]}for(p=c;p<this.m;p++)this.U[p][c]=-this.U[p][c];this.U[c][c]=1+this.U[c][c];for(p=0;p<c-1;p++)this.U[p][c]=0}else{for(p=0;p<this.m;p++)this.U[p][c]=0;this.U[c][c]=1}for(var y,b,c=this.n-1;0<=c;c--){if(y=c<v,b=0!==f[c],y&&b)for(m=c+1;m<s;m++){for(g=0,p=c+1;p<this.n;p++)g+=this.V[p][c]*this.V[p][m];g=-g/this.V[c+1][c];for(p=c+1;p<this.n;p++)this.V[p][m]+=g*this.V[p][c]}for(p=0;p<this.n;p++)this.V[p][c]=0;this.V[c][c]=1}for(var M=d-1,x=Math.pow(2,-52),A=Math.pow(2,-966);0<d;){var c=void 0,j=void 0;for(c=d-2;-1<=c&&-1!==c;c--)if(Math.abs(f[c])<=A+x*(Math.abs(this.s[c])+Math.abs(this.s[c+1]))){f[c]=0;break}if(c===d-2)j=4;else{for(var w=void 0,w=d-1;c<=w&&w!==c;w--){g=(w!==d?Math.abs(f[w]):0)+(w!==c+1?Math.abs(f[w-1]):0);if(Math.abs(this.s[w])<=A+x*g){this.s[w]=0;break}}w===c?j=3:w===d-1?j=1:(j=2,c=w)}switch(c++,j){case 1:var H=f[d-2];f[d-2]=0;for(m=d-2;c<=m;m--){var g=Maths.hypot(this.s[m],H),E=this.s[m]/g,V=H/g;this.s[m]=g,m!==c&&(H=-V*f[m-1],f[m-1]=E*f[m-1]);for(p=0;p<this.n;p++)g=E*this.V[p][m]+V*this.V[p][d-1],this.V[p][d-1]=-V*this.V[p][m]+E*this.V[p][d-1],this.V[p][m]=g}break;case 2:H=f[c-1];f[c-1]=0;for(m=c;m<d;m++){g=Maths.hypot(this.s[m],H),E=this.s[m]/g,V=H/g;this.s[m]=g,H=-V*f[m],f[m]=E*f[m];for(p=0;p<this.m;p++)g=E*this.U[p][m]+V*this.U[p][c-1],this.U[p][c-1]=-V*this.U[p][m]+E*this.U[p][c-1],this.U[p][m]=g}break;case 3:var _=Math.max(Math.max(Math.max(Math.max(Math.abs(this.s[d-1]),Math.abs(this.s[d-2])),Math.abs(f[d-2])),Math.abs(this.s[c])),Math.abs(f[c])),D=this.s[d-1]/_,O=this.s[d-2]/_,R=f[d-2]/_,U=this.s[c]/_,$=f[c]/_,_=((O+D)*(O-D)+R*R)/2,O=D*R*(D*R),R=0;0==_&&0==O||(R=Math.sqrt(_*_+O),_<0&&(R=-R),R=O/(_+R));for(var H=(U+D)*(U-D)+R,L=U*$,m=c;m<d-1;m++){E=H/(g=Maths.hypot(H,L)),V=L/g;m!==c&&(f[m-1]=g),H=E*this.s[m]+V*f[m],f[m]=E*f[m]-V*this.s[m],L=V*this.s[m+1],this.s[m+1]=E*this.s[m+1];for(p=0;p<this.n;p++)g=E*this.V[p][m]+V*this.V[p][m+1],this.V[p][m+1]=-V*this.V[p][m]+E*this.V[p][m+1],this.V[p][m]=g;if(E=H/(g=Maths.hypot(H,L)),V=L/g,this.s[m]=g,H=E*f[m]+V*this.s[m+1],this.s[m+1]=-V*f[m]+E*this.s[m+1],L=V*f[m+1],f[m+1]=E*f[m+1],m<this.m-1)for(p=0;p<this.m;p++)g=E*this.U[p][m]+V*this.U[p][m+1],this.U[p][m+1]=-V*this.U[p][m]+E*this.U[p][m+1],this.U[p][m]=g}f[d-2]=H,0;break;case 4:if(this.s[c]<=0){this.s[c]=this.s[c]<0?-this.s[c]:0;for(p=0;p<=M;p++)this.V[p][c]=-this.V[p][c]}for(;c<M&&!(this.s[c]>=this.s[c+1]);){g=this.s[c];if(this.s[c]=this.s[c+1],this.s[c+1]=g,c<this.n-1)for(p=0;p<this.n;p++)g=this.V[p][c+1],this.V[p][c+1]=this.V[p][c],this.V[p][c]=g;if(c<this.m-1)for(p=0;p<this.m;p++)g=this.U[p][c+1],this.U[p][c+1]=this.U[p][c],this.U[p][c]=g;c++}d--}}}return t.prototype.getU=function(){return new Matrix(this.U,this.m,Math.min(this.m+1,this.n))},t.prototype.getV=function(){return new Matrix(this.V,this.n,this.n)},t.prototype.getSingularValues=function(){return this.s},t.prototype.getS=function(){for(var t=new Matrix(this.n,this.n),i=t.getArray(),s=0;s<this.n;s++){for(var r=0;r<this.n;r++)i[s][r]=0;i[s][s]=this.s[s]}return t},t.prototype.norm2=function(){return this.s[0]},t.prototype.cond=function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},t.prototype.rank=function(){for(var t=Math.pow(2,-52),i=Math.max(this.m,this.n)*this.s[0]*t,s=0,r=0;r<this.s.length;r++)this.s[r]>i&&s++;return s},t.serialVersionUID=1,t}();SingularValueDecomposition.__class="SingularValueDecomposition",SingularValueDecomposition.__interfaces=["java.io.Serializable"];var QRDecomposition=function(){function t(t){void 0===this.QR&&(this.QR=null),void 0===this.m&&(this.m=0),void 0===this.n&&(this.n=0),void 0===this.Rdiag&&(this.Rdiag=null),this.QR=t.getArrayCopy(),this.m=t.getRowDimension(),this.n=t.getColumnDimension(),this.Rdiag=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.n);for(var i=0;i<this.n;i++){for(var s=0,r=i;r<this.m;r++)s=Maths.hypot(s,this.QR[r][i]);if(0!==s){this.QR[i][i]<0&&(s=-s);for(r=i;r<this.m;r++)this.QR[r][i]/=s;this.QR[i][i]+=1;for(var n=i+1;n<this.n;n++){for(var h=0,r=i;r<this.m;r++)h+=this.QR[r][i]*this.QR[r][n];h=-h/this.QR[i][i];for(r=i;r<this.m;r++)this.QR[r][n]+=h*this.QR[r][i]}}this.Rdiag[i]=-s}}return t.prototype.isFullRank=function(){for(var t=0;t<this.n;t++)if(0===this.Rdiag[t])return!1;return!0},t.prototype.getH=function(){for(var t=new Matrix(this.m,this.n),i=t.getArray(),s=0;s<this.m;s++)for(var r=0;r<this.n;r++)i[s][r]=r<=s?this.QR[s][r]:0;return t},t.prototype.getR=function(){for(var t=new Matrix(this.n,this.n),i=t.getArray(),s=0;s<this.n;s++)for(var r=0;r<this.n;r++)i[s][r]=s<r?this.QR[s][r]:s===r?this.Rdiag[s]:0;return t},t.prototype.getQ=function(){for(var t=new Matrix(this.m,this.n),i=t.getArray(),s=this.n-1;0<=s;s--){for(var r=0;r<this.m;r++)i[r][s]=0;i[s][s]=1;for(var n=s;n<this.n;n++)if(0!==this.QR[s][s]){for(var h=0,r=s;r<this.m;r++)h+=this.QR[r][s]*i[r][n];h=-h/this.QR[s][s];for(r=s;r<this.m;r++)i[r][n]+=h*this.QR[r][s]}}return t},t.prototype.solve=function(t){if(t.getRowDimension()!==this.m)throw Object.defineProperty(new Error("Matrix row dimensions must agree."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if(!this.isFullRank())throw Object.defineProperty(new Error("Matrix is rank deficient."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]});for(var i=t.getColumnDimension(),s=t.getArrayCopy(),r=0;r<this.n;r++)for(var n=0;n<i;n++){for(var h=0,o=r;o<this.m;o++)h+=this.QR[o][r]*s[o][n];h=-h/this.QR[r][r];for(o=r;o<this.m;o++)s[o][n]+=h*this.QR[o][r]}for(r=this.n-1;0<=r;r--){for(n=0;n<i;n++)s[r][n]/=this.Rdiag[r];for(o=0;o<r;o++)for(n=0;n<i;n++)s[o][n]-=s[r][n]*this.QR[o][r]}return new Matrix(s,this.n,i).getMatrix$int$int$int$int(0,this.n-1,0,i-1)},t.serialVersionUID=1,t}();QRDecomposition.__class="QRDecomposition",QRDecomposition.__interfaces=["java.io.Serializable"];var LUDecomposition=function(){function t(t){void 0===this.LU&&(this.LU=null),void 0===this.m&&(this.m=0),void 0===this.n&&(this.n=0),void 0===this.pivsign&&(this.pivsign=0),void 0===this.piv&&(this.piv=null),this.LU=t.getArrayCopy(),this.m=t.getRowDimension(),this.n=t.getColumnDimension(),this.piv=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.m);for(var i,s=0;s<this.m;s++)this.piv[s]=s;this.pivsign=1;for(var r,n,h=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.m),o=0;o<this.n;o++){for(s=0;s<this.m;s++)h[s]=this.LU[s][o];for(s=0;s<this.m;s++){i=this.LU[s];for(var e=Math.min(s,o),a=0,f=0;f<e;f++)a+=i[f]*h[f];i[o]=h[s]-=a}for(var u=o,s=o+1;s<this.m;s++)Math.abs(h[s])>Math.abs(h[u])&&(u=s);if(u!==o){for(var l=0;l<this.n;l++){var v=this.LU[u][l];this.LU[u][l]=this.LU[o][l],this.LU[o][l]=v}f=this.piv[u];this.piv[u]=this.piv[o],this.piv[o]=f,this.pivsign=-this.pivsign}if(r=o<this.m,n=0!==this.LU[o][o],r&&n)for(s=o+1;s<this.m;s++)this.LU[s][o]/=this.LU[o][o]}}return t.prototype.isNonsingular=function(){for(var t=0;t<this.n;t++)if(0===this.LU[t][t])return!1;return!0},t.prototype.getL=function(){for(var t=new Matrix(this.m,this.n),i=t.getArray(),s=0;s<this.m;s++)for(var r=0;r<this.n;r++)i[s][r]=r<s?this.LU[s][r]:s===r?1:0;return t},t.prototype.getU=function(){for(var t=new Matrix(this.n,this.n),i=t.getArray(),s=0;s<this.n;s++)for(var r=0;r<this.n;r++)i[s][r]=s<=r?this.LU[s][r]:0;return t},t.prototype.getPivot=function(){for(var t=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},t.prototype.getDoublePivot=function(){for(var t=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},t.prototype.det=function(){if(this.m!==this.n)throw Object.defineProperty(new Error("Matrix must be square."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});for(var t=this.pivsign,i=0;i<this.n;i++)t*=this.LU[i][i];return t},t.prototype.solve=function(t){if(t.getRowDimension()!==this.m)throw Object.defineProperty(new Error("Matrix row dimensions must agree."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if(!this.isNonsingular())throw Object.defineProperty(new Error("Matrix is singular."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]});for(var i=t.getColumnDimension(),t=t.getMatrix$int_A$int$int(this.piv,0,i-1),s=t.getArray(),r=0;r<this.n;r++)for(var n=r+1;n<this.n;n++)for(var h=0;h<i;h++)s[n][h]-=s[r][h]*this.LU[n][r];for(r=this.n-1;0<=r;r--){for(h=0;h<i;h++)s[r][h]/=this.LU[r][r];for(n=0;n<r;n++)for(h=0;h<i;h++)s[n][h]-=s[r][h]*this.LU[n][r]}return t},t.serialVersionUID=1,t}();LUDecomposition.__class="LUDecomposition",LUDecomposition.__interfaces=["java.io.Serializable"];var EigenvalueDecomposition=function(){function t(t){void 0===this.n&&(this.n=0),void 0===this.issymmetric&&(this.issymmetric=!1),void 0===this.d&&(this.d=null),void 0===this.e&&(this.e=null),void 0===this.V&&(this.V=null),void 0===this.H&&(this.H=null),void 0===this.ort&&(this.ort=null),void 0===this.cdivr&&(this.cdivr=0),void 0===this.cdivi&&(this.cdivi=0);var r,i=t.getArray();this.n=t.getColumnDimension(),this.V=(t=[this.n,this.n],(r=function(t){if(0===t.length)return 0;for(var i=[],s=0;s<t[0];s++)i.push(r(t.slice(1)));return i})(t)),this.d=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.n),this.e=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.n),this.issymmetric=!0;for(var s,n,h,o,e,a=0;h=a<this.n,o=this.issymmetric,h&&o;a++)for(var f=0;s=f<this.n,n=this.issymmetric,s&&n;f++)this.issymmetric=i[f][a]===i[a][f];if(this.issymmetric){for(f=0;f<this.n;f++)for(a=0;a<this.n;a++)this.V[f][a]=i[f][a];this.tred2(),this.tql2()}else{this.H=(t=[this.n,this.n],(e=function(t){if(0===t.length)return 0;for(var i=[],s=0;s<t[0];s++)i.push(e(t.slice(1)));return i})(t)),this.ort=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.n);for(a=0;a<this.n;a++)for(f=0;f<this.n;f++)this.H[f][a]=i[f][a];this.orthes(),this.hqr2()}}return t.prototype.tred2=function(){for(var t=0;t<this.n;t++)this.d[t]=this.V[this.n-1][t];for(var i=this.n-1;0<i;i--){for(var s=0,r=0,n=0;n<i;n++)s+=Math.abs(this.d[n]);if(0===s){this.e[i]=this.d[i-1];for(t=0;t<i;t++)this.d[t]=this.V[i-1][t],this.V[i][t]=0,this.V[t][i]=0}else{for(n=0;n<i;n++)this.d[n]/=s,r+=this.d[n]*this.d[n];var h=this.d[i-1],o=Math.sqrt(r);0<h&&(o=-o),this.e[i]=s*o,r-=h*o,this.d[i-1]=h-o;for(t=0;t<i;t++)this.e[t]=0;for(t=0;t<i;t++){h=this.d[t],this.V[t][i]=h,o=this.e[t]+this.V[t][t]*h;for(n=t+1;n<=i-1;n++)o+=this.V[n][t]*this.d[n],this.e[n]+=this.V[n][t]*h;this.e[t]=o}for(t=h=0;t<i;t++)this.e[t]/=r,h+=this.e[t]*this.d[t];for(var e=h/(r+r),t=0;t<i;t++)this.e[t]-=e*this.d[t];for(t=0;t<i;t++){h=this.d[t],o=this.e[t];for(n=t;n<=i-1;n++)this.V[n][t]-=h*this.e[n]+o*this.d[n];this.d[t]=this.V[i-1][t],this.V[i][t]=0}}this.d[i]=r}for(i=0;i<this.n-1;i++){if(this.V[this.n-1][i]=this.V[i][i],this.V[i][i]=1,0!==(r=this.d[i+1])){for(n=0;n<=i;n++)this.d[n]=this.V[n][i+1]/r;for(t=0;t<=i;t++){for(o=0,n=0;n<=i;n++)o+=this.V[n][i+1]*this.V[n][t];for(n=0;n<=i;n++)this.V[n][t]-=o*this.d[n]}}for(n=0;n<=i;n++)this.V[n][i+1]=0}for(t=0;t<this.n;t++)this.d[t]=this.V[this.n-1][t],this.V[this.n-1][t]=0;this.V[this.n-1][this.n-1]=1,this.e[0]=0},t.prototype.tql2=function(){for(var t=1;t<this.n;t++)this.e[t-1]=this.e[t];for(var i=this.e[this.n-1]=0,s=0,r=Math.pow(2,-52),n=0;n<this.n;n++){s=Math.max(s,Math.abs(this.d[n])+Math.abs(this.e[n]));for(var h=n;h<this.n&&!(Math.abs(this.e[h])<=r*s);)h++;if(n<h)do{0;var o=this.d[n],e=(this.d[n+1]-o)/(2*this.e[n]),a=Maths.hypot(e,1);e<0&&(a=-a),this.d[n]=this.e[n]/(e+a),this.d[n+1]=this.e[n]*(e+a);for(var f=this.d[n+1],u=o-this.d[n],t=n+2;t<this.n;t++)this.d[t]-=u;i+=u,e=this.d[h];for(var l=1,v=l,c=l,p=this.e[n+1],m=0,g=0,t=h-1;n<=t;t--){c=v,g=m,o=(v=l)*this.e[t],u=l*e,a=Maths.hypot(e,this.e[t]),this.e[t+1]=m*a,m=this.e[t]/a,e=(l=e/a)*this.d[t]-m*o,this.d[t+1]=u+m*(l*o+m*this.d[t]);for(var d=0;d<this.n;d++)u=this.V[d][t+1],this.V[d][t+1]=m*this.V[d][t]+l*u,this.V[d][t]=l*this.V[d][t]-m*u}}while(e=-m*g*c*p*this.e[n]/f,this.e[n]=m*e,this.d[n]=l*e,Math.abs(this.e[n])>r*s);this.d[n]=this.d[n]+i,this.e[n]=0}for(t=0;t<this.n-1;t++){for(var d=t,e=this.d[t],y=t+1;y<this.n;y++)this.d[y]<e&&(d=y,e=this.d[y]);if(d!==t){this.d[d]=this.d[t],this.d[t]=e;for(y=0;y<this.n;y++)e=this.V[y][t],this.V[y][t]=this.V[y][d],this.V[y][d]=e}}},t.prototype.orthes=function(){for(var t=this.n-1,i=1;i<=t-1;i++){for(var s=0,r=i;r<=t;r++)s+=Math.abs(this.H[r][i-1]);if(0!==s){for(var n=0,r=t;i<=r;r--)this.ort[r]=this.H[r][i-1]/s,n+=this.ort[r]*this.ort[r];var h=Math.sqrt(n);0<this.ort[i]&&(h=-h),n-=this.ort[i]*h,this.ort[i]=this.ort[i]-h;for(var o=i;o<this.n;o++){for(var e=0,r=t;i<=r;r--)e+=this.ort[r]*this.H[r][o];e/=n;for(r=i;r<=t;r++)this.H[r][o]-=e*this.ort[r]}for(r=0;r<=t;r++){for(e=0,o=t;i<=o;o--)e+=this.ort[o]*this.H[r][o];e/=n;for(o=i;o<=t;o++)this.H[r][o]-=e*this.ort[o]}this.ort[i]=s*this.ort[i],this.H[i][i-1]=s*h}}for(r=0;r<this.n;r++)for(o=0;o<this.n;o++)this.V[r][o]=r===o?1:0;for(i=t-1;1<=i;i--)if(0!==this.H[i][i-1]){for(r=i+1;r<=t;r++)this.ort[r]=this.H[r][i-1];for(o=i;o<=t;o++){for(h=0,r=i;r<=t;r++)h+=this.ort[r]*this.V[r][o];h=h/this.ort[i]/this.H[i][i-1];for(r=i;r<=t;r++)this.V[r][o]+=h*this.ort[r]}}},t.prototype.cdiv=function(t,i,s,r){var n,h;Math.abs(s)>Math.abs(r)?(h=s+(n=r/s)*r,this.cdivr=(t+n*i)/h,this.cdivi=(i-n*t)/h):(h=r+(n=s/r)*s,this.cdivr=(n*t+i)/h,this.cdivi=(n*i-t)/h)},t.prototype.hqr2=function(){for(var t,i,s,r,n=this.n,h=n-1,o=n-1,e=Math.pow(2,-52),a=0,f=0,u=0,l=0,v=0,c=0,p=0,m=0;m<n;m++){(m<0||o<m)&&(this.d[m]=this.H[m][m],this.e[m]=0);for(var g=Math.max(m-1,0);g<n;g++)p+=Math.abs(this.H[m][g])}for(var d=0;0<=h;){for(var y=h;0<y&&(0===(v=Math.abs(this.H[y-1][y-1])+Math.abs(this.H[y][y]))&&(v=p),!(Math.abs(this.H[y][y-1])<e*v));)y--;if(y===h)this.H[h][h]=this.H[h][h]+a,this.d[h]=this.H[h][h],this.e[h]=0,h--,d=0;else if(y===h-1){if(i=this.H[h][h-1]*this.H[h-1][h],u=(f=(this.H[h-1][h-1]-this.H[h][h])/2)*f+i,c=Math.sqrt(Math.abs(u)),this.H[h][h]=this.H[h][h]+a,this.H[h-1][h-1]=this.H[h-1][h-1]+a,s=this.H[h][h],0<=u){c=0<=f?f+c:f-c,this.d[h-1]=s+c,this.d[h]=this.d[h-1],0!==c&&(this.d[h]=s-i/c),this.e[h-1]=0,this.e[h]=0,f=(s=this.H[h][h-1])/(v=Math.abs(s)+Math.abs(c)),u=c/v,f/=l=Math.sqrt(f*f+u*u),u/=l;for(g=h-1;g<n;g++)c=this.H[h-1][g],this.H[h-1][g]=u*c+f*this.H[h][g],this.H[h][g]=u*this.H[h][g]-f*c;for(m=0;m<=h;m++)c=this.H[m][h-1],this.H[m][h-1]=u*c+f*this.H[m][h],this.H[m][h]=u*this.H[m][h]-f*c;for(m=0;m<=o;m++)c=this.V[m][h-1],this.V[m][h-1]=u*c+f*this.V[m][h],this.V[m][h]=u*this.V[m][h]-f*c}else this.d[h-1]=s+f,this.d[h]=s+f,this.e[h-1]=c,this.e[h]=-c;h-=2,d=0}else{if(s=this.H[h][h],i=r=0,y<h&&(r=this.H[h-1][h-1],i=this.H[h][h-1]*this.H[h-1][h]),10===d){a+=s;for(m=0;m<=h;m++)this.H[m][m]-=s;s=r=.75*(v=Math.abs(this.H[h][h-1])+Math.abs(this.H[h-1][h-2])),i=-.4375*v*v}if(30===d&&0<(v=(v=(r-s)/2)*v+i)){v=Math.sqrt(v),r<s&&(v=-v),v=s-i/((r-s)/2+v);for(m=0;m<=h;m++)this.H[m][m]-=v;a+=v,s=r=i=.964}d+=1;for(var b=h-2;y<=b&&(f=((l=s-(c=this.H[b][b]))*(v=r-c)-i)/this.H[b+1][b]+this.H[b][b+1],u=this.H[b+1][b+1]-c-l-v,l=this.H[b+2][b+1],f/=v=Math.abs(f)+Math.abs(u)+Math.abs(l),u/=v,l/=v,b!==y)&&!(Math.abs(this.H[b][b-1])*(Math.abs(u)+Math.abs(l))<e*(Math.abs(f)*(Math.abs(this.H[b-1][b-1])+Math.abs(c)+Math.abs(this.H[b+1][b+1]))));)b--;for(m=b+2;m<=h;m++)this.H[m][m-2]=0,b+2<m&&(this.H[m][m-3]=0);for(var M=b;M<=h-1;M++){var x=M!==h-1;if(M!==b){if(f=this.H[M][M-1],u=this.H[M+1][M-1],l=x?this.H[M+2][M-1]:0,0===(s=Math.abs(f)+Math.abs(u)+Math.abs(l)))continue;f/=s,u/=s,l/=s}if(v=Math.sqrt(f*f+u*u+l*l),f<0&&(v=-v),0!==v){M!==b?this.H[M][M-1]=-v*s:y!==b&&(this.H[M][M-1]=-this.H[M][M-1]),s=(f+=v)/v,r=u/v,c=l/v,u/=f,l/=f;for(g=M;g<n;g++)f=this.H[M][g]+u*this.H[M+1][g],x&&(f+=l*this.H[M+2][g],this.H[M+2][g]=this.H[M+2][g]-f*c),this.H[M][g]=this.H[M][g]-f*s,this.H[M+1][g]=this.H[M+1][g]-f*r;for(m=0;m<=Math.min(h,M+3);m++)f=s*this.H[m][M]+r*this.H[m][M+1],x&&(f+=c*this.H[m][M+2],this.H[m][M+2]=this.H[m][M+2]-f*l),this.H[m][M]=this.H[m][M]-f,this.H[m][M+1]=this.H[m][M+1]-f*u;for(m=0;m<=o;m++)f=s*this.V[m][M]+r*this.V[m][M+1],x&&(f+=c*this.V[m][M+2],this.V[m][M+2]=this.V[m][M+2]-f*l),this.V[m][M]=this.V[m][M]-f,this.V[m][M+1]=this.V[m][M+1]-f*u}}}}if(0!==p){for(h=n-1;0<=h;h--)if(f=this.d[h],0===(u=this.e[h]))for(y=h,m=h-(this.H[h][h]=1);0<=m;m--){i=this.H[m][m]-f,l=0;for(g=y;g<=h;g++)l+=this.H[m][g]*this.H[g][h];if(this.e[m]<0)c=i,v=l;else if(y=m,0===this.e[m]?this.H[m][h]=0!==i?-l/i:-l/(e*p):(s=this.H[m][m+1],r=this.H[m+1][m],t=(s*v-c*l)/(u=(this.d[m]-f)*(this.d[m]-f)+this.e[m]*this.e[m]),this.H[m][h]=t,Math.abs(s)>Math.abs(c)?this.H[m+1][h]=(-l-i*t)/s:this.H[m+1][h]=(-v-r*t)/c),1<e*(t=Math.abs(this.H[m][h]))*t)for(g=m;g<=h;g++)this.H[g][h]=this.H[g][h]/t}else if(u<0){y=h-1;Math.abs(this.H[h][h-1])>Math.abs(this.H[h-1][h])?(this.H[h-1][h-1]=u/this.H[h][h-1],this.H[h-1][h]=-(this.H[h][h]-f)/this.H[h][h-1]):(this.cdiv(0,-this.H[h-1][h],this.H[h-1][h-1]-f,u),this.H[h-1][h-1]=this.cdivr,this.H[h-1][h]=this.cdivi),this.H[h][h-1]=0,this.H[h][h]=1;for(m=h-2;0<=m;m--){for(var A,j=void 0,w=void 0,H=void 0,j=0,w=0,g=y;g<=h;g++)j+=this.H[m][g]*this.H[g][h-1],w+=this.H[m][g]*this.H[g][h];if(i=this.H[m][m]-f,this.e[m]<0)c=i,l=j,v=w;else if(y=m,0===this.e[m]?(this.cdiv(-j,-w,i,u),this.H[m][h-1]=this.cdivr,this.H[m][h]=this.cdivi):(s=this.H[m][m+1],r=this.H[m+1][m],H=(this.d[m]-f)*(this.d[m]-f)+this.e[m]*this.e[m]-u*u,A=2*(this.d[m]-f)*u,0===H&&0==A&&(H=e*p*(Math.abs(i)+Math.abs(u)+Math.abs(s)+Math.abs(r)+Math.abs(c))),this.cdiv(s*l-c*j+u*w,s*v-c*w-u*j,H,A),this.H[m][h-1]=this.cdivr,this.H[m][h]=this.cdivi,Math.abs(s)>Math.abs(c)+Math.abs(u)?(this.H[m+1][h-1]=(-j-i*this.H[m][h-1]+u*this.H[m][h])/s,this.H[m+1][h]=(-w-i*this.H[m][h]-u*this.H[m][h-1])/s):(this.cdiv(-l-r*this.H[m][h-1],-v-r*this.H[m][h],c,u),this.H[m+1][h-1]=this.cdivr,this.H[m+1][h]=this.cdivi)),1<e*(t=Math.max(Math.abs(this.H[m][h-1]),Math.abs(this.H[m][h])))*t)for(g=m;g<=h;g++)this.H[g][h-1]=this.H[g][h-1]/t,this.H[g][h]=this.H[g][h]/t}}for(m=0;m<n;m++)if(m<0||o<m)for(g=m;g<n;g++)this.V[m][g]=this.H[m][g];for(g=n-1;0<=g;g--)for(m=0;m<=o;m++){for(M=c=0;M<=Math.min(g,o);M++)c+=this.V[m][M]*this.H[M][g];this.V[m][g]=c}}},t.prototype.getV=function(){return new Matrix(this.V,this.n,this.n)},t.prototype.getRealEigenvalues=function(){return this.d},t.prototype.getImagEigenvalues=function(){return this.e},t.prototype.getD=function(){for(var t=new Matrix(this.n,this.n),i=t.getArray(),s=0;s<this.n;s++){for(var r=0;r<this.n;r++)i[s][r]=0;i[s][s]=this.d[s],0<this.e[s]?i[s][s+1]=this.e[s]:this.e[s]<0&&(i[s][s-1]=this.e[s])}return t},t.serialVersionUID=1,t}();EigenvalueDecomposition.__class="EigenvalueDecomposition",EigenvalueDecomposition.__interfaces=["java.io.Serializable"];var CholeskyDecomposition=function(){function t(t){void 0===this.L&&(this.L=null),void 0===this.n&&(this.n=0),void 0===this.isspd&&(this.isspd=!1);var i,r,s=t.getArray();this.n=t.getRowDimension(),this.L=(i=[this.n,this.n],(r=function(t){if(0===t.length)return 0;for(var i=[],s=0;s<t[0];s++)i.push(r(t.slice(1)));return i})(i)),this.isspd=t.getColumnDimension()===this.n;for(var n,h,o=0;o<this.n;o++){for(var e=this.L[o],a=0,f=0;f<o;f++){for(var u=this.L[f],l=0,v=0;v<f;v++)l+=u[v]*e[v];e[f]=l=(s[o][f]-l)/this.L[f][f],a+=l*l,this.isspd=(n=this.isspd,h=s[f][o]===s[o][f],n&&h)}a=s[o][o]-a,this.isspd=this.isspd&&a>0,this.L[o][o]=Math.sqrt(Math.max(a,0));for(f=o+1;f<this.n;f++)this.L[o][f]=0}}return t.prototype.isSPD=function(){return this.isspd},t.prototype.getL=function(){return new Matrix(this.L,this.n,this.n)},t.prototype.solve=function(t){if(t.getRowDimension()!==this.n)throw Object.defineProperty(new Error("Matrix row dimensions must agree."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if(!this.isspd)throw Object.defineProperty(new Error("Matrix is not symmetric positive definite."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]});for(var i=t.getArrayCopy(),s=t.getColumnDimension(),r=0;r<this.n;r++)for(var n=0;n<s;n++){for(var h=0;h<r;h++)i[r][n]-=i[h][n]*this.L[r][h];i[r][n]/=this.L[r][r]}for(r=this.n-1;0<=r;r--)for(n=0;n<s;n++){for(h=r+1;h<this.n;h++)i[r][n]-=i[h][n]*this.L[h][r];i[r][n]/=this.L[r][r]}return new Matrix(i,this.n,s)},t.serialVersionUID=1,t}();CholeskyDecomposition.__class="CholeskyDecomposition",CholeskyDecomposition.__interfaces=["java.io.Serializable"];var Matrix=function(){function f(t,i,s){if(!(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||t[0]instanceof Array)||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof s&&null!==s)if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof s&&null!==s)if(!(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)||"number"!=typeof i&&null!==i||void 0!==s)if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||void 0!==s){if(!(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||t[0]instanceof Array)||null===t)||void 0!==i||void 0!==s)throw new Error("invalid overload");l=arguments;void 0===this.A&&(this.A=null),void 0===this.m&&(this.m=0),void 0===this.n&&(this.n=0),this.m=t.length,this.n=t[0].length;for(o=0;o<this.m;o++)if(t[o].length!==this.n)throw Object.defineProperty(new Error("All rows must have the same length."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.A=t}else{var r=(l=arguments)[0],n=l[1];void 0===this.A&&(this.A=null),void 0===this.m&&(this.m=0),void 0===this.n&&(this.n=0),this.m=r,this.n=n,this.A=(v=function(t){if(0===t.length)return 0;for(var i=[],s=0;s<t[0];s++)i.push(v(t.slice(1)));return i})([r,n])}else{var h=(l=arguments)[0];if(void 0===this.A&&(this.A=null),void 0===this.m&&(this.m=0),void 0===this.n&&(this.n=0),this.m=i,this.n=0!==i?h.length/i|0:0,i*this.n!==h.length)throw Object.defineProperty(new Error("Array length must be a multiple of m."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.A=(n=[i,this.n],(c=function(t){if(0===t.length)return 0;for(var i=[],s=0;s<t[0];s++)i.push(c(t.slice(1)));return i})(n));for(var o=0;o<i;o++)for(u=0;u<this.n;u++)this.A[o][u]=h[o+u*i]}else{var e=(l=arguments)[0],a=l[1],f=l[2];void 0===this.A&&(this.A=null),void 0===this.m&&(this.m=0),void 0===this.n&&(this.n=0),this.m=e,this.n=a,this.A=(p=function(t){if(0===t.length)return 0;for(var i=[],s=0;s<t[0];s++)i.push(p(t.slice(1)));return i})([e,a]);for(var o=0;o<e;o++)for(var u=0;u<a;u++)this.A[o][u]=f}else{var l=arguments;void 0===this.A&&(this.A=null),void 0===this.m&&(this.m=0),void 0===this.n&&(this.n=0),this.A=t,this.m=i,this.n=s}var v,c,p}return f.constructWithCopy=function(t){for(var i=t.length,s=t[0].length,r=new f(i,s),n=r.getArray(),h=0;h<i;h++){if(t[h].length!==s)throw Object.defineProperty(new Error("All rows must have the same length."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});for(var o=0;o<s;o++)n[h][o]=t[h][o]}return r},f.prototype.copy=function(){for(var t=new f(this.m,this.n),i=t.getArray(),s=0;s<this.m;s++)for(var r=0;r<this.n;r++)i[s][r]=this.A[s][r];return t},f.prototype.clone=function(){return this.copy()},f.prototype.getArray=function(){return this.A},f.prototype.getArrayCopy=function(){for(var t,r,i=(t=[this.m,this.n],(r=function(t){if(0===t.length)return 0;for(var i=[],s=0;s<t[0];s++)i.push(r(t.slice(1)));return i})(t)),s=0;s<this.m;s++)for(var n=0;n<this.n;n++)i[s][n]=this.A[s][n];return i},f.prototype.getColumnPackedCopy=function(){for(var t=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.m*this.n),i=0;i<this.m;i++)for(var s=0;s<this.n;s++)t[i+s*this.m]=this.A[i][s];return t},f.prototype.getRowPackedCopy=function(){for(var t=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.m*this.n),i=0;i<this.m;i++)for(var s=0;s<this.n;s++)t[i*this.n+s]=this.A[i][s];return t},f.prototype.getRowDimension=function(){return this.m},f.prototype.getColumnDimension=function(){return this.n},f.prototype.get=function(t,i){return this.A[t][i]},f.prototype.getMatrix$int$int$int$int=function(t,i,s,r){var n=new f(i-t+1,r-s+1),h=n.getArray();try{for(var o=t;o<=i;o++)for(var e=s;e<=r;e++){if(void 0===this.A[o][e]||void 0===h[o-t][e-s])throw new Error("undefined");h[o-t][e-s]=this.A[o][e]}}catch(t){throw Object.defineProperty(new Error("Submatrix indices"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.ArrayIndexOutOfBoundsException","java.lang.RuntimeException","java.lang.Exception"]})}return n},f.prototype.getMatrix=function(t,i,s,r){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof s&&null!==s||"number"!=typeof r&&null!==r){if(!(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof s&&null!==s||void 0!==r){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||!(null!=s&&s instanceof Array&&(0==s.length||null==s[0]||"number"==typeof s[0])||null===s)||void 0!==r){if((null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)&&(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||"number"==typeof i[0])||null===i)&&void 0===s&&void 0===r)return this.getMatrix$int_A$int_A(t,i);throw new Error("invalid overload")}return this.getMatrix$int$int$int_A(t,i,s)}return this.getMatrix$int_A$int$int(t,i,s)}return this.getMatrix$int$int$int$int(t,i,s,r)},f.prototype.getMatrix$int_A$int_A=function(t,i){var s=new f(t.length,i.length),r=s.getArray();try{for(var n=0;n<t.length;n++)for(var h=0;h<i.length;h++){if(void 0===this.A[t[n]][i[h]]||void 0===r[n][h])throw new Error("undefined");r[n][h]=this.A[t[n]][i[h]]}}catch(t){throw Object.defineProperty(new Error("Submatrix indices"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.ArrayIndexOutOfBoundsException","java.lang.RuntimeException","java.lang.Exception"]})}return s},f.prototype.getMatrix$int$int$int_A=function(t,i,s){var r=new f(i-t+1,s.length),n=r.getArray();try{for(var h=t;h<=i;h++)for(var o=0;o<s.length;o++){if(void 0===this.A[h][s[o]]||void 0===n[h-t][o])throw new Error("undefined");n[h-t][o]=this.A[h][s[o]]}}catch(t){throw Object.defineProperty(new Error("Submatrix indices"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.ArrayIndexOutOfBoundsException","java.lang.RuntimeException","java.lang.Exception"]})}return r},f.prototype.getMatrix$int_A$int$int=function(t,i,s){var r=new f(t.length,s-i+1),n=r.getArray();try{for(var h=0;h<t.length;h++)for(var o=i;o<=s;o++){if(void 0===this.A[t[h]][o]||void 0===n[h][o-i])throw new Error("undefined");n[h][o-i]=this.A[t[h]][o]}}catch(t){throw Object.defineProperty(new Error("Submatrix indices"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.ArrayIndexOutOfBoundsException","java.lang.RuntimeException","java.lang.Exception"]})}return r},f.prototype.set=function(t,i,s){this.A[t][i]=s},f.prototype.setMatrix$int$int$int$int$Matrix=function(t,i,s,r,n){try{for(var h=t;h<=i;h++)for(var o=s;o<=r;o++){if(void 0===n.get(h-t,o-s)||void 0===this.A[h][o])throw new Error("undefined");this.A[h][o]=n.get(h-t,o-s)}}catch(t){throw Object.defineProperty(new Error("Submatrix indices"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.ArrayIndexOutOfBoundsException","java.lang.RuntimeException","java.lang.Exception"]})}},f.prototype.setMatrix=function(t,i,s,r,n){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof s&&null!==s||"number"!=typeof r&&null!==r||!(null!=n&&n instanceof f||null===n)){if(!(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof s&&null!==s||!(null!=r&&r instanceof f||null===r)||void 0!==n){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||!(null!=s&&s instanceof Array&&(0==s.length||null==s[0]||"number"==typeof s[0])||null===s)||!(null!=r&&r instanceof f||null===r)||void 0!==n){if((null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)&&(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||"number"==typeof i[0])||null===i)&&(null!=s&&s instanceof f||null===s)&&void 0===r&&void 0===n)return this.setMatrix$int_A$int_A$Matrix(t,i,s);throw new Error("invalid overload")}return this.setMatrix$int$int$int_A$Matrix(t,i,s,r)}return this.setMatrix$int_A$int$int$Matrix(t,i,s,r)}return this.setMatrix$int$int$int$int$Matrix(t,i,s,r,n)},f.prototype.setMatrix$int_A$int_A$Matrix=function(t,i,s){try{for(var r=0;r<t.length;r++)for(var n=0;n<i.length;n++){if(void 0===s.get(r,n)||void 0===this.A[t[r]][i[n]])throw new Error("undefined");this.A[t[r]][i[n]]=s.get(r,n)}}catch(t){throw Object.defineProperty(new Error("Submatrix indices"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.ArrayIndexOutOfBoundsException","java.lang.RuntimeException","java.lang.Exception"]})}},f.prototype.setMatrix$int_A$int$int$Matrix=function(t,i,s,r){try{for(var n=0;n<t.length;n++)for(var h=i;h<=s;h++){if(void 0===r.get(n,h-i)||void 0===this.A[t[n]][h])throw new Error("undefined");this.A[t[n]][h]=r.get(n,h-i)}}catch(t){throw Object.defineProperty(new Error("Submatrix indices"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.ArrayIndexOutOfBoundsException","java.lang.RuntimeException","java.lang.Exception"]})}},f.prototype.setMatrix$int$int$int_A$Matrix=function(t,i,s,r){try{for(var n=t;n<=i;n++)for(var h=0;h<s.length;h++){if(void 0===r.get(n-t,h)||void 0===this.A[n][s[h]])throw new Error("undefined");this.A[n][s[h]]=r.get(n-t,h)}}catch(t){throw Object.defineProperty(new Error("Submatrix indices"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.ArrayIndexOutOfBoundsException","java.lang.RuntimeException","java.lang.Exception"]})}},f.prototype.transpose=function(){for(var t=new f(this.n,this.m),i=t.getArray(),s=0;s<this.m;s++)for(var r=0;r<this.n;r++)i[r][s]=this.A[s][r];return t},f.prototype.norm1=function(){for(var t=0,i=0;i<this.n;i++){for(var s=0,r=0;r<this.m;r++)s+=Math.abs(this.A[r][i]);t=Math.max(t,s)}return t},f.prototype.norm2=function(){return new SingularValueDecomposition(this).norm2()},f.prototype.normInf=function(){for(var t=0,i=0;i<this.m;i++){for(var s=0,r=0;r<this.n;r++)s+=Math.abs(this.A[i][r]);t=Math.max(t,s)}return t},f.prototype.normF=function(){for(var t=0,i=0;i<this.m;i++)for(var s=0;s<this.n;s++)t=Maths.hypot(t,this.A[i][s]);return t},f.prototype.uminus=function(){for(var t=new f(this.m,this.n),i=t.getArray(),s=0;s<this.m;s++)for(var r=0;r<this.n;r++)i[s][r]=-this.A[s][r];return t},f.prototype.plus=function(t){this.checkMatrixDimensions(t);for(var i=new f(this.m,this.n),s=i.getArray(),r=0;r<this.m;r++)for(var n=0;n<this.n;n++)s[r][n]=this.A[r][n]+t.A[r][n];return i},f.prototype.plusEquals=function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var s=0;s<this.n;s++)this.A[i][s]=this.A[i][s]+t.A[i][s];return this},f.prototype.minus=function(t){this.checkMatrixDimensions(t);for(var i=new f(this.m,this.n),s=i.getArray(),r=0;r<this.m;r++)for(var n=0;n<this.n;n++)s[r][n]=this.A[r][n]-t.A[r][n];return i},f.prototype.minusEquals=function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var s=0;s<this.n;s++)this.A[i][s]=this.A[i][s]-t.A[i][s];return this},f.prototype.arrayTimes=function(t){this.checkMatrixDimensions(t);for(var i=new f(this.m,this.n),s=i.getArray(),r=0;r<this.m;r++)for(var n=0;n<this.n;n++)s[r][n]=this.A[r][n]*t.A[r][n];return i},f.prototype.arrayTimesEquals=function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var s=0;s<this.n;s++)this.A[i][s]=this.A[i][s]*t.A[i][s];return this},f.prototype.arrayRightDivide=function(t){this.checkMatrixDimensions(t);for(var i=new f(this.m,this.n),s=i.getArray(),r=0;r<this.m;r++)for(var n=0;n<this.n;n++)s[r][n]=this.A[r][n]/t.A[r][n];return i},f.prototype.arrayRightDivideEquals=function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var s=0;s<this.n;s++)this.A[i][s]=this.A[i][s]/t.A[i][s];return this},f.prototype.arrayLeftDivide=function(t){this.checkMatrixDimensions(t);for(var i=new f(this.m,this.n),s=i.getArray(),r=0;r<this.m;r++)for(var n=0;n<this.n;n++)s[r][n]=t.A[r][n]/this.A[r][n];return i},f.prototype.arrayLeftDivideEquals=function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var s=0;s<this.n;s++)this.A[i][s]=t.A[i][s]/this.A[i][s];return this},f.prototype.times$double=function(t){for(var i=new f(this.m,this.n),s=i.getArray(),r=0;r<this.m;r++)for(var n=0;n<this.n;n++)s[r][n]=t*this.A[r][n];return i},f.prototype.timesEquals=function(t){for(var i=0;i<this.m;i++)for(var s=0;s<this.n;s++)this.A[i][s]=t*this.A[i][s];return this},f.prototype.times$Matrix=function(t){if(t.m!==this.n)throw Object.defineProperty(new Error("Matrix inner dimensions must agree."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});for(var i=new f(this.m,t.n),s=i.getArray(),r=function(t){for(var i=[];0<t--;)i.push(0);return i}(this.n),n=0;n<t.n;n++){for(var h=0;h<this.n;h++)r[h]=t.A[h][n];for(var o=0;o<this.m;o++){for(var e=this.A[o],a=0,h=0;h<this.n;h++)a+=e[h]*r[h];s[o][n]=a}}return i},f.prototype.times=function(t){if(null!=t&&t instanceof f||null===t)return this.times$Matrix(t);if("number"==typeof t||null===t)return this.times$double(t);throw new Error("invalid overload")},f.prototype.lu=function(){return new LUDecomposition(this)},f.prototype.qr=function(){return new QRDecomposition(this)},f.prototype.chol=function(){return new CholeskyDecomposition(this)},f.prototype.svd=function(){return new SingularValueDecomposition(this)},f.prototype.eig=function(){return new EigenvalueDecomposition(this)},f.prototype.solve=function(t){return new(this.m===this.n?LUDecomposition:QRDecomposition)(this).solve(t)},f.prototype.solveTranspose=function(t){return this.transpose().solve(t.transpose())},f.prototype.inverse=function(){return this.solve(f.identity(this.m,this.m))},f.prototype.det=function(){return new LUDecomposition(this).det()},f.prototype.rank=function(){return new SingularValueDecomposition(this).rank()},f.prototype.cond=function(){return new SingularValueDecomposition(this).cond()},f.prototype.trace=function(){for(var t=0,i=0;i<Math.min(this.m,this.n);i++)t+=this.A[i][i];return t},f.random=function(t,i){for(var s=new f(t,i),r=s.getArray(),n=0;n<t;n++)for(var h=0;h<i;h++)r[n][h]=Math.random();return s},f.identity=function(t,i){for(var s=new f(t,i),r=s.getArray(),n=0;n<t;n++)for(var h=0;h<i;h++)r[n][h]=n===h?1:0;return s},f.prototype.print=function(t,i){t+=2,console.info();for(var s=0;s<this.m;s++)for(var r=0;r<this.n;r++){for(var n=this.A[s][r].toFixed(i),h=Math.max(1,t-n.length),o=0;o<h;o++)console.info(" ");console.info(n)}},f.prototype.checkMatrixDimensions=function(t){if(t.m!==this.m||t.n!==this.n)throw Object.defineProperty(new Error("Matrix dimensions must agree."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]})},f.serialVersionUID=1,f}();Matrix.__class="Matrix",Matrix.__interfaces=["java.lang.Cloneable","java.io.Serializable"];