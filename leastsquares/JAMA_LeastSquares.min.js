"use strict";var LeastSquares=function(){function LeastSquares(t,e,r=null,s=null){t.length!=e.length&&console.log("arrays must be the same length"),this.x=t,this.y=e,this.z=null==r?[]:r,this.w=null==s?[]:s,this.f={add:"+",sub:"-",div:"/",mlt:"*",mod:"%",pow:"^"},this.f.orderOfOp=[[[this.f.pow]],[[this.f.mlt],[this.f.div],[this.f.mod]],[[this.f.add],[this.f.sub]]]}return LeastSquares.prototype.line=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],e[r][0]=this.y[r],t[r][0]=this.x[r],t[r][1]=1;return t=new Matrix(t),e=new Matrix(e),t.solve(e)},LeastSquares.prototype.line3D=function(){var avg=[];avg[0]=eval(this.x.join("+"))/this.x.length,avg[1]=eval(this.y.join("+"))/this.y.length,avg[2]=eval(this.z.join("+"))/this.z.length;for(var A=[],i=0;i<this.x.length;i++)A[i]=[],A[i][0]=this.x[i]-avg[0],A[i][1]=this.y[i]-avg[1],A[i][2]=this.z[i]-avg[2];A=new Matrix(A);var res=A.svd();console.log(res.V);for(var out=[],i=0;i<3;i++)out[i]=[],out[i][0]=avg[i],out[i][1]=res.V[i][0];return new Matrix(out)},LeastSquares.prototype.plane=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],t[r][0]=this.x[r],t[r][1]=this.y[r],t[r][2]=1,e[r][0]=this.z[r];return t=new Matrix(t),e=new Matrix(e),t.solve(e)},LeastSquares.prototype.parab=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],e[r][0]=this.y[r],t[r][2]=1,t[r][1]=this.x[r],t[r][0]=this.x[r]*t[r][1];return t=new Matrix(t),e=new Matrix(e),t.solve(e)},LeastSquares.prototype.poly=function(t){for(var e=[],r=[],s=0;s<this.x.length;s++){e[s]=[],r[s]=[],r[s][0]=this.y[s];for(var a=t-(e[s][t]=1);0<=a;a--)e[s][a]=this.x[s]*e[s][a+1]}return e=new Matrix(e),r=new Matrix(r),e.solve(r)},LeastSquares.prototype.poly2D=function(t,e,r=-1){for(var s=[],a=[],i=Math.max(t,e),n=0;n<this.x.length;n++){s[n]=[],a[n]=[];for(var o=0,h=1,l=0;l<=t;l++){for(var p=1,x=0;x<=e;x++)l+x<=i&&(s[n][o++]=h*p),p*=this.y[n];h*=this.x[n]}a[n][0]=this.z[n]}s=new Matrix(s),a=new Matrix(a);var u=s.solve(a);if(-1!=r){for(var c=[],h="",l=0;l<=t;l++){p="";for(x=0;x<=e;x++)l+x<=i&&(l+x==0?c.push("C"):c.push(h+p)),p+="y";h+="x"}for(var f=0;f<c.length;f++)r[c[f]]=u.A[f][0]}return u},LeastSquares.prototype.poly3D=function(t,e,r,s=-1){if(null==this.z)return console.log("ERROR: No Z Data, cannot compute 3D polynomial"),null;if(null==this.w){console.log("WARNING: No W Data, setting all W values to 1."),this.w=[];for(var a=0;a<this.x.length;a++)this.w.push(1)}for(var i=[],n=[],o=Math.max(Math.max(t,e),r),a=0;a<this.x.length;a++){i[a]=[],n[a]=[];for(var h=0,l=1,p=0;p<=t;p++){for(var x=1,u=0;u<=e;u++){for(var c=1,f=0;f<=r;f++)p+u+f<=o&&(i[a][h++]=l*x*c),c*=this.z[a];x*=this.y[a]}l*=this.x[a]}n[a][0]=this.w[a]}i=new Matrix(i),n=new Matrix(n);var y=i.solve(n);if(-1!=s){for(var g=[],l="",p=0;p<=t;p++){x="";for(u=0;u<=e;u++){c="";for(f=0;f<=r;f++)p+u+f<=o&&(p+u+f==0?g.push("C"):g.push(l+x+c)),c+="z";x+="y"}l+="x"}for(var v=0;v<g.length;v++)s[g[v]]=y.A[v][0]}return y},LeastSquares.prototype.log=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],e[r][0]=this.y[r],t[r][0]=Math.log(this.x[r]),t[r][1]=1;return t=new Matrix(t),e=new Matrix(e),t.solve(e)},LeastSquares.prototype.powLin=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],e[r][0]=Math.log(this.y[r]),t[r][0]=Math.log(this.x[r]),t[r][1]=1;t=new Matrix(t),e=new Matrix(e);var s=t.solve(e);return s.A[1][0]=Math.exp(s.A[1][0]),s},LeastSquares.prototype.expLin=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],e[r][0]=Math.log(this.y[r]),t[r][0]=this.x[r],t[r][1]=1;t=new Matrix(t),e=new Matrix(e);var s=t.solve(e);return s.A[1][0]=Math.exp(s.A[1][0]),s},LeastSquares.prototype.sinLinFreq=function(t,e=1,r=e){for(var s=[],a=[],i=0;i<this.x.length;i++){s[i]=[],a[i]=[],a[i][0]=this.y[i];for(var n=e,o=t-(s[i][t]=1);0<=o;o--)s[i][o]=Math.sin(this.x[i]*n),n+=r}return s=new Matrix(s),a=new Matrix(a),s.solve(a)},LeastSquares.prototype.cosLinFreq=function(t,e=1,r=e){for(var s=[],a=[],i=0;i<this.x.length;i++){s[i]=[],a[i]=[],a[i][0]=this.y[i];for(var n=e,o=t-(s[i][t]=1);0<=o;o--)s[i][o]=Math.cos(this.x[i]*n),n+=r}return s=new Matrix(s),a=new Matrix(a),s.solve(a)},LeastSquares.prototype.sinCosLinFreq=function(t,e=1,r=e){for(var s=[],a=[],i=0;i<this.x.length;i++){s[i]=[],a[i]=[],a[i][0]=this.y[i];for(var n=e,o=2*t-(s[i][2*t]=1);0<=o;o-=2)s[i][o]=Math.sin(this.x[i]*n),s[i][o-1]=Math.cos(this.x[i]*n),n+=r}return s=new Matrix(s),a=new Matrix(a),s.solve(a)},LeastSquares.prototype.sinExpFreq=function(t,e=1,r=2){for(var s=[],a=[],i=0;i<this.x.length;i++){s[i]=[],a[i]=[],a[i][0]=this.y[i];for(var n=e,o=t-(s[i][t]=1);0<=o;o--)s[i][o]=Math.sin(this.x[i]*n),n*=r}return s=new Matrix(s),a=new Matrix(a),s.solve(a)},LeastSquares.prototype.cosExpFreq=function(t,e=1,r=2){for(var s=[],a=[],i=0;i<this.x.length;i++){s[i]=[],a[i]=[],a[i][0]=this.y[i];for(var n=e,o=t-(s[i][t]=1);0<=o;o--)s[i][o]=Math.cos(this.x[i]*n),n*=r}return s=new Matrix(s),a=new Matrix(a),s.solve(a)},LeastSquares.prototype.sinCosExpFreq=function(t,e=1,r=2){for(var s=[],a=[],i=0;i<this.x.length;i++){s[i]=[],a[i]=[],a[i][0]=this.y[i];for(var n=e,o=2*t-(s[i][2*t]=1);0<=o;o-=2)s[i][o]=Math.sin(this.x[i]*n),s[i][o-1]=Math.cos(this.x[i]*n),n*=r}return s=new Matrix(s),a=new Matrix(a),s.solve(a)},LeastSquares.prototype.sinCos2DLinFreq=function(t,e,r=[1,1],s=[1,1]){for(var a=[],i=[],n=0;n<this.x.length;n++){a[n]=[],i[n]=[],i[n][0]=this.z[n],a[n][0]=1;for(var o=r.slice(),h=1,l=0;l<t;l++)a[n][h++]=Math.sin(this.x[n]*o[0]),a[n][h++]=Math.cos(this.x[n]*o[0]),o[0]+=s[0];for(var p=0;p<e;p++)a[n][h++]=Math.sin(this.y[n]*o[1]),a[n][h++]=Math.cos(this.y[n]*o[1]),o[1]+=s[1]}return a=new Matrix(a),i=new Matrix(i),a.solve(i)},LeastSquares.prototype.sinCos2DExpFreq=function(t,e,r=[1,1],s=[2,2]){for(var a=[],i=[],n=0;n<this.x.length;n++){a[n]=[],i[n]=[],i[n][0]=this.z[n],a[n][0]=1;for(var o=r.slice(),h=1,l=0;l<t;l++)a[n][h++]=Math.sin(this.x[n]*o[0]),a[n][h++]=Math.cos(this.x[n]*o[0]),o[0]*=s[0];for(var p=0;p<e;p++)a[n][h++]=Math.sin(this.y[n]*o[1]),a[n][h++]=Math.cos(this.y[n]*o[1]),o[1]*=s[1]}return a=new Matrix(a),i=new Matrix(i),a.solve(i)},LeastSquares.prototype.ellipse=function(){},LeastSquares.prototype.ellipseGen=function(t=-1,e=5){return 0==e?this.ellipseGenA(t):1==e?this.ellipseGenB(t):2==e?this.ellipseGenC(t):3==e?this.ellipseGenD(t):4==e?this.ellipseGenE(t):this.ellipseGenF(t)},LeastSquares.prototype.ellipseGenA=function(t=-1){for(var e=[],r=[],s=0;s<this.x.length;s++)e[s]=[],r[s]=[],e[s][4]=1,e[s][3]=this.y[s],e[s][2]=this.x[s],e[s][1]=this.y[s]*this.y[s],e[s][0]=this.x[s]*this.y[s],r[s][0]=-this.x[s]*this.x[s];e=new Matrix(e),r=new Matrix(r);var a=e.solve(r),i=[];i[0]=[];for(s=i[0][0]=1;s<6;s++)i[s]=[],i[s][0]=a.A[s-1][0];return this.returnEllipse(i,t)},LeastSquares.prototype.ellipseGenB=function(t=-1){for(var e=[],r=[],s=0;s<this.x.length;s++)e[s]=[],r[s]=[],e[s][4]=1,e[s][3]=this.y[s],e[s][2]=this.x[s],e[s][1]=this.y[s]*this.y[s],e[s][0]=this.x[s]*this.x[s],r[s][0]=-this.x[s]*this.y[s];e=new Matrix(e),r=new Matrix(r);for(var a=e.solve(r),i=[],s=0;s<5;s++)0==s?(i[s]=[],i[s][0]=a.A[s][0]):(i[s+1]=[],i[s+1][0]=a.A[s][0]);return i[1]=[],i[1][0]=1,this.returnEllipse(i,t)},LeastSquares.prototype.ellipseGenC=function(t=-1){for(var e=[],r=[],s=0;s<this.x.length;s++)e[s]=[],r[s]=[],e[s][4]=1,e[s][3]=this.y[s],e[s][2]=this.x[s],e[s][1]=this.x[s]*this.y[s],e[s][0]=this.x[s]*this.x[s],r[s][0]=-this.y[s]*this.y[s];e=new Matrix(e),r=new Matrix(r);for(var a=e.solve(r),i=[],s=0;s<5;s++)s<=1?(i[s]=[],i[s][0]=a.A[s][0]):(i[s+1]=[],i[s+1][0]=a.A[s][0]);return i[2]=[],i[2][0]=1,this.returnEllipse(i,t)},LeastSquares.prototype.ellipseGenD=function(t=-1){for(var e=[],r=[],s=0;s<this.x.length;s++)e[s]=[],r[s]=[],e[s][4]=1,e[s][3]=this.y[s],e[s][2]=this.y[s]*this.y[s],e[s][1]=this.x[s]*this.y[s],e[s][0]=this.x[s]*this.x[s],r[s][0]=-this.x[s];e=new Matrix(e),r=new Matrix(r);for(var a=e.solve(r),i=[],s=0;s<5;s++)s<=2?(i[s]=[],i[s][0]=a.A[s][0]):(i[s+1]=[],i[s+1][0]=a.A[s][0]);return i[3]=[],i[3][0]=1,this.returnEllipse(i,t)},LeastSquares.prototype.ellipseGenE=function(t=-1){for(var e=[],r=[],s=0;s<this.x.length;s++)e[s]=[],r[s]=[],e[s][4]=1,e[s][3]=this.x[s],e[s][2]=this.y[s]*this.y[s],e[s][1]=this.x[s]*this.y[s],e[s][0]=this.x[s]*this.x[s],r[s][0]=-this.y[s];e=new Matrix(e),r=new Matrix(r);for(var a=e.solve(r),i=[],s=0;s<5;s++)s<=3?(i[s]=[],i[s][0]=a.A[s][0]):(i[s+1]=[],i[s+1][0]=a.A[s][0]);return i[4]=[],i[4][0]=1,this.returnEllipse(i,t)},LeastSquares.prototype.ellipseGenF=function(t=-1){for(var e=[],r=[],s=0;s<this.x.length;s++)e[s]=[],r[s]=[],r[s][0]=-1,e[s][4]=this.y[s],e[s][3]=this.x[s],e[s][2]=this.y[s]*e[s][4],e[s][1]=this.x[s]*this.y[s],e[s][0]=this.x[s]*e[s][3];e=new Matrix(e),r=new Matrix(r);for(var a=e.solve(r),i=[],s=0;s<5;s++)i[s]=[],i[s][0]=a.A[s][0];return i[5]=[],i[5][0]=1,this.returnEllipse(i,t)},LeastSquares.prototype.returnEllipse=function(t,e=-1){var r=t[0][0],s=t[1][0],a=t[2][0],i=t[3][0],n=t[4][0],o=s*s,h=r-a,l=r+a,p=a*i,x=s*i,u=s*n,c=r*n,f=o-4*r*a,i=2*((c-x)*n+a*i*i+f*t[5][0]),h=Math.sqrt(h*h+o),o=-Math.sqrt(i*(l+h))/f,l=-Math.sqrt(i*(l-h))/f,u=(2*p-u)/f,x=(2*c-x)/f,f=0,f=0==s?a<r?0:Math.PI:Math.atan(1/s*(a-r-h));return-1!=e&&(e.x_c=u,e.y_c=x,e.a_r=o,e.b_r=l,e.theta=f),new Matrix(t)},LeastSquares.prototype.equationParse=function(t,e,r=-1){var s=this.equationParseParse(t,e,0),t=[this.x.length,this.y.length,this.z.length,this.w.length];-1==r&&(r=["x","y","z","w"][t.findLastIndex(t=>0<t)]);for(var a=Math.max.apply(Math,t),i={},n=[],o=[],h=0;h<a;h++){i.x=this.x[h],i.y=this.y[h],i.z=this.z[h],i.w=this.w[h],n[h]=[],o[h]=[],o[h][0]=i[r];for(var l=0;l<s.length;l++)n[h].push(Number(this.equationParseCalcInput(s[l],i)))}n=new Matrix(n),o=new Matrix(o);var p,x=n.solve(o);for(p in e){var u=e[p];e[p]=x.A[u][0]}return x},LeastSquares.prototype.equationParseEvaluate=function(t,e,r,s=-1){var a=this.equationParseParse(t,e,1);null==r.y&&(r.y=[]),null==r.z&&(r.z=[]),null==r.w&&(r.w=[]);e=[r.x.length,r.y.length,r.z.length,r.w.length];-1==s&&(s=["x","y","z","w"][e.findLastIndex(t=>0<t)]);for(var i=Math.max.apply(Math,e),n={},o=[],h=0;h<i;h++){n.x=r.x[h],n.y=r.y[h],n.z=r.z[h],n.w=r.w[h],o.push(0);for(var l=0;l<a.length;l++)o[h]+=Number(this.equationParseCalcInput(a[l],n))}return o},LeastSquares.prototype.equationParseParse=function(t,e,r){for(var s=0,a=[],i=t.replace(/\s+/g,"");i.match(/\(([^()]*)\)/g);){a[s]=i.match(/\(([^()]*)\)/g);var n="REPLACESTR"+s,i=i.replace(/\(([^()]*)\)/g,n);s++}var o=i.replace(/\-(?![^(]*\))/g,"+-").split(/\+(?![^(]*\))/);""==o[0]&&o.shift();for(var h=[],l=0;l<s;l++)h.push(0);for(var p=0;p<o.length;p++){for(l=s-1;0<=l;l--)for(var n="REPLACESTR"+l,x=new RegExp(n,"");o[p].match(x);)o[p]=o[p].replace(x,a[l][h[l]]),h[l]++;if(r){var u,c=Object.keys(e);for(u in c.sort(function(t,e){return e.length-t.length}),c){var f=c[u],y=new RegExp("(\\-?)("+f+")(\\**)(.*)");if(o[p].match(y)){f=e[f],n=RegExp.$1+f+RegExp.$3+RegExp.$4;o[p]=o[p].replace(y,n);break}}}else{var g=o[p].match(/(\-?)([A-Za-z]+)\**(.*)/)[2];o[e[g]=p].match(/(\-?)([A-Za-z]+)\**(.*)/)&&(n=""==RegExp.$3?RegExp.$1+1:RegExp.$1+RegExp.$3,o[p]=o[p].replace(/(\-?)([A-Za-z]+)\**(.*)/,n))}g=o[p].match(/(sqrt|sin|cos|tan|exp|pow|log|[0-9xyzwEe%\^*\/()\-+.,])/g);o[p]=g.join("")}return o},LeastSquares.prototype.equationParseCalcInput=function(t,e){for(var r,s=/(sqrt|sin|cos|tan|exp|pow|log)*\(([^()]*)\)/,a=/([xyzw])/;r=t.match(s);)if("pow"==r[1]){var i=r[2].split(","),n=/((\d*\.?\d+|\d+)([Ee][+-]?\d+)?|[xyzw])([+*/^%-])(-?(\d*\.?\d+|\d+)([Ee][+-]?\d+)?|-?[xyzw])/;i[0].match(n)?i[0]=this.equationParseCalcInputNoParentheses(i[0],e):i[0].match(a)&&(i[0]=i[0].replace(a,e[RegExp.$1])),i[1].match(n)?i[1]=this.equationParseCalcInputNoParentheses(i[1],e):i[1].match(a)&&(i[1]=i[1].replace(a,e[RegExp.$1]));var o=Math.pow(i[0],i[1]);t=t.replace(s,o)}else if(i=r[0].match(/(sqrt|sin|cos|tan|exp|log)/)){n=/((\d*\.?\d+|\d+)([Ee][+-]?\d+)?|[xyzw])([+*/^%-])(-?(\d*\.?\d+|\d+)([Ee][+-]?\d+)?|-?[xyzw])/;switch(r[2].match(n)&&(r[2]=this.equationParseCalcInputNoParentheses(r[2],e)),r[2].match(a)&&(r[2]=r[2].replace(a,e[RegExp.$1])),i[0]){case"sqrt":o=Math.sqrt(r[2]);break;case"sin":o=Math.sin(r[2]);break;case"cos":o=Math.cos(r[2]);break;case"tan":o=Math.tan(r[2]);break;case"exp":o=Math.exp(r[2]);break;case"log":o=Math.log(r[2])}t=t.replace(s,o)}else{n=/((\d*\.?\d+|\d+)([Ee][+-]?\d+)?|[xyzw])([+*/^%-])(-?(\d*\.?\d+|\d+)([Ee][+-]?\d+)?|-?[xyzw])/;r[2].match(n)?o=this.equationParseCalcInputNoParentheses(r[2],e):(o=r[2]).match(a)&&(o=o.replace(a,e[RegExp.$1])),t=t.replace(s,o)}return t.match(/((\d*\.?\d+|\d+)([Ee][+-]?\d+)?|[xyzw])([+*/^%-])(-?(\d*\.?\d+|\d+)([Ee][+-]?\d+)?|-?[xyzw])/)?o=this.equationParseCalcInputNoParentheses(t,e):(o=t).match(a)&&(o=o.replace(a,e[RegExp.$1])),o.match(/--/)&&(o=o.replace(/--/,"")),o},LeastSquares.prototype.equationParseCalcInputNoParentheses=function(t,e){for(var r=0,s=this.f.orderOfOp.length;r<s;r++)for(var a=0,i=this.f.orderOfOp[r].length;a<i;a++){var n=2==r?new RegExp("(^[-+]?(?:\\d*\\.?\\d+|\\d+)(?:[Ee][+-]?\\d+)?|[xyzw])([\\"+this.f.orderOfOp[r][a]+"])(-?(?:\\d*\\.?\\d+|\\d+)(?:[Ee][+-]?\\d+)?|-?[xyzw])"):new RegExp("((?:\\d*\\.?\\d+|\\d+)(?:[Ee][+-]?\\d+)?|[xyzw])([\\"+this.f.orderOfOp[r][a]+"])(-?(?:\\d*\\.?\\d+|\\d+)(?:[Ee][+-]?\\d+)?|-?[xyzw])");for(n.lastIndex=0;n.test(t);){if(output=this.equationParse_calculate(RegExp.$1,RegExp.$2,RegExp.$3,e),isNaN(output)||!isFinite(output))return output;t=t.replace(n,output)}}return t.match(/--/)&&(t=t.replace(/--/,"")),t},LeastSquares.prototype.equationParse_calculate=function(t,e,r,s){switch("x"==t&&(t=s.x),"y"==t&&(t=s.y),"z"==t&&(t=s.z),"w"==t&&(t=s.w),"x"==r&&(r=s.x),"y"==r&&(r=s.y),"z"==r&&(r=s.z),"w"==r&&(r=s.w),t=+t,r=+r,e){case this.f.add:return t+r;case this.f.sub:return t-r;case this.f.div:return t/r;case this.f.mlt:return t*r;case this.f.mod:return t%r;case this.f.pow:return Math.pow(t,r)}},LeastSquares.prototype.sphere3D=function(t=-1){for(var e=[],r=[],s=0;s<this.x.length;s++)e[s]=[],r[s]=[],r[s][0]=-1,e[s][8]=this.z[s],e[s][7]=this.y[s],e[s][6]=this.x[s],e[s][5]=this.y[s]*this.z[s],e[s][4]=this.x[s]*this.z[s],e[s][3]=this.x[s]*this.y[s],e[s][2]=this.z[s]*this.z[s],e[s][1]=this.y[s]*this.y[s],e[s][0]=this.x[s]*this.x[s];e=new Matrix(e),r=new Matrix(r);var a=e.solve(r),i=a.A[0][0],n=a.A[1][0],o=a.A[2][0],h=.5*a.A[3][0],l=.5*a.A[4][0],p=.5*a.A[5][0],x=a.A[6][0],u=a.A[7][0],c=a.A[8][0],f=l*l,y=p*p,g=l*p-o*h,v=h*p-n*l,w=h*l-i*p,M=n*i-h*h,d=2*h*l*p+o*M-i*y-n*f,y=-.5*(x*(n*o-y)+u*g+c*v)/d,f=-.5*(x*g+u*(o*i-f)+c*w)/d,M=-.5*(x*v+u*w+c*M)/d,d=[[i,h,l],[h,n,p],[l,p,o]],i=[[y],[f],[M]],d=new Matrix(d),h=(i=new Matrix(i)).transpose(),n=d.times(i),l=h.times(n).A[0][0]-1,p=d.times(1/l).eig(),o=1/Math.sqrt(Math.abs(-p.d[0])),i=1/Math.sqrt(Math.abs(-p.d[1])),h=1/Math.sqrt(Math.abs(-p.d[2])),n=Math.sqrt(1-p.V[2][0]*p.V[2][0]),d=Math.asin(p.V[2][0]),l=Math.atan2(p.V[2][1]/n,p.V[2][2]/n),n=Math.atan2(p.V[1][0]/n,p.V[0][0]/n);return-1!=t&&(t.x_c=y,t.y_c=f,t.z_c=M,t.a_r=o,t.b_r=i,t.c_r=h,t.alpha=n,t.beta=d,t.gamma=l,t.eigV=p.V),a},LeastSquares.runLeastSquaresTest=function(){var t=[.083488725,.972233795,.519432488,.557793421,.300510972,.529587317,.288370293,.295974099,.972950908,.562190618,.485386043,.187655207,.173117839,.401618916,.510703949,.834813425,.913974888,.358703401,.037429811,.809497463,.285912045,.153523603,.966634609,.529821905,.592251179,.710151685,.611030014,.137094865,.619995355,.185711451],e=[.154093159,.560237285,.301702746,.233999395,.319387128,.912314852,.055485191,.131389179,.584452711,.121399731,.478089423,.527552888,.30823643,.401301559,.39393612,.057959329,.429895272,.212793677,.058030451,.128383908,.069685073,.588424668,.129995286,.895030989,.310668533,.286987422,.714797546,.238023745,.842531267,.710897663],r=new LeastSquares(t,e);console.log("x data"),console.log(t),console.log("y data"),console.log(e),console.log("line fit");t=r.line();t.print(5,3),console.log("parabola fit"),(t=r.parab()).print(5,3),console.log("5th degree poly fit"),(t=r.poly(5)).print(5,3),console.log("8th degree poly fit"),(t=r.poly(8)).print(5,3),console.log("Logarithmic fit"),(t=r.log()).print(5,3),console.log("3rd degree exp freq sin fit (10Hz start freq)"),(t=r.sinExpFreq(3,10,2)).print(5,3),console.log("3rd degree exp freq cos fit (10Hz start freq)"),(t=r.cosExpFreq(3,10,2)).print(5,3),console.log("3rd degree exp freq sin-cos fit (10Hz start freq)"),(t=r.sinCosExpFreq(3,10,2)).print(5,3);e=[-4,-3,-2,-1,0,1,2,3,4],r=[-1,0,-1.5,.5,1,-1,-.5,2,-1];console.log("x data"),console.log(e),console.log("y data"),console.log(r);e=new LeastSquares(e,r);console.log("3rd degree linear freq sin fit"),(t=e.sinLinFreq(3)).print(5,3),console.log("3rd degree linear freq cos fit"),(t=e.cosLinFreq(3)).print(5,3),console.log("3rd degree linear freq sin-cos fit"),(t=e.sinCosLinFreq(3)).print(5,3);console.log("Exponential fit (Linear LS)");r=new LeastSquares([1.006,1.666,3.418,3.605,4.562,6.166,7.331,7.642,8.745,9.971,10.924,11.702,12.802,14.339,14.901],[.853,1.625,5.326,4.168,9.873,14.529,21.579,25.018,33.839,45.783,59.037,76.58,94.795,123.343,161.893]);(t=r.expLin()).print(5,3),console.log("Power law fit (Linear LS)"),(t=r.powLin()).print(5,3),console.log("Elliptical Fits");e=new LeastSquares(xElp,yElp);console.log("Ellipse with default, no return parameters (only Ax2+Bxy+Cy2+Dx+Ey+F matrix)"),(t=e.ellipseGen()).print(5,3);r={};t=e.ellipseGen(r,0),console.log("Ellipse parameters (x2 as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3),r={},t=e.ellipseGen(r,1),console.log("Ellipse parameters (xy as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3),r={},t=e.ellipseGen(r,2),console.log("Ellipse parameters (y2 as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3),r={},t=e.ellipseGen(r,3),console.log("Ellipse parameters (x as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3),r={},t=e.ellipseGen(r,4),console.log("Ellipse parameters (y as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3),r={},t=e.ellipseGen(r,5),console.log("Ellipse parameters (Const as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3)},LeastSquares}();Matrix.__class="LeastSquares",Matrix.__interfaces=["java.lang.Cloneable","java.io.Serializable"];