"use strict";var LeastSquares=function(){function i(t,e){t.length!=e.length&&console.log("arrays must be the same length"),this.x=t,this.y=e}return i.prototype.line=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],e[r][0]=this.y[r],t[r][0]=this.x[r],t[r][1]=1;return t=new Matrix(t),e=new Matrix(e),t.solve(e)},i.prototype.parab=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],e[r][0]=this.y[r],t[r][2]=1,t[r][1]=this.x[r],t[r][0]=this.x[r]*t[r][1];return t=new Matrix(t),e=new Matrix(e),t.solve(e)},i.prototype.poly=function(t){for(var e=[],r=[],i=0;i<this.x.length;i++){e[i]=[],r[i]=[],r[i][0]=this.y[i];for(var n=t-(e[i][t]=1);0<=n;n--)e[i][n]=this.x[i]*e[i][n+1]}return e=new Matrix(e),r=new Matrix(r),e.solve(r)},i.prototype.log=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],e[r][0]=this.y[r],t[r][0]=Math.log(this.x[r]),t[r][1]=1;return t=new Matrix(t),e=new Matrix(e),t.solve(e)},i.prototype.powLin=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],e[r][0]=Math.log(this.y[r]),t[r][0]=Math.log(this.x[r]),t[r][1]=1;t=new Matrix(t),e=new Matrix(e);var i=t.solve(e);return i.A[1][0]=Math.exp(i.A[1][0]),i},i.prototype.expLin=function(){for(var t=[],e=[],r=0;r<this.x.length;r++)t[r]=[],e[r]=[],e[r][0]=Math.log(this.y[r]),t[r][0]=this.x[r],t[r][1]=1;t=new Matrix(t),e=new Matrix(e);var i=t.solve(e);return i.A[1][0]=Math.exp(i.A[1][0]),i},i.prototype.sinLinFreq=function(t,e=1){for(var r=[],i=[],n=0;n<this.x.length;n++){r[n]=[],i[n]=[],i[n][0]=this.y[n];for(var s=e,o=t-(r[n][t]=1);0<=o;o--)r[n][o]=Math.sin(this.x[n]*s),s+=1}return r=new Matrix(r),i=new Matrix(i),r.solve(i)},i.prototype.cosLinFreq=function(t,e=1){for(var r=[],i=[],n=0;n<this.x.length;n++){r[n]=[],i[n]=[],i[n][0]=this.y[n];for(var s=e,o=t-(r[n][t]=1);0<=o;o--)r[n][o]=Math.cos(this.x[n]*s),s+=1}return r=new Matrix(r),i=new Matrix(i),r.solve(i)},i.prototype.sinCosLinFreq=function(t,e=1){for(var r=[],i=[],n=0;n<this.x.length;n++){r[n]=[],i[n]=[],i[n][0]=this.y[n];for(var s=e,o=2*t-(r[n][2*t]=1);0<=o;o-=2)r[n][o]=Math.sin(this.x[n]*s),r[n][o-1]=Math.cos(this.x[n]*s),s+=1}return r=new Matrix(r),i=new Matrix(i),r.solve(i)},i.prototype.sinExpFreq=function(t,e=1,r=2){for(var i=[],n=[],s=0;s<this.x.length;s++){i[s]=[],n[s]=[],n[s][0]=this.y[s];for(var o=e,l=t-(i[s][t]=1);0<=l;l--)i[s][l]=Math.sin(this.x[s]*o),o*=r}return i=new Matrix(i),n=new Matrix(n),i.solve(n)},i.prototype.cosExpFreq=function(t,e=1,r=2){for(var i=[],n=[],s=0;s<this.x.length;s++){i[s]=[],n[s]=[],n[s][0]=this.y[s];for(var o=e,l=t-(i[s][t]=1);0<=l;l--)i[s][l]=Math.cos(this.x[s]*o),o*=r}return i=new Matrix(i),n=new Matrix(n),i.solve(n)},i.prototype.sinCosExpFreq=function(t,e=1,r=2){for(var i=[],n=[],s=0;s<this.x.length;s++){i[s]=[],n[s]=[],n[s][0]=this.y[s];for(var o=e,l=2*t-(i[s][2*t]=1);0<=l;l-=2)i[s][l]=Math.sin(this.x[s]*o),i[s][l-1]=Math.cos(this.x[s]*o),o*=r}return i=new Matrix(i),n=new Matrix(n),i.solve(n)},i.prototype.ellipse=function(){},i.prototype.ellipseGen=function(t=-1,e=5){return 0==e?this.ellipseGenA(t):1==e?this.ellipseGenB(t):2==e?this.ellipseGenC(t):3==e?this.ellipseGenD(t):4==e?this.ellipseGenE(t):this.ellipseGenF(t)},i.prototype.ellipseGenA=function(t=-1){for(var e=[],r=[],i=0;i<this.x.length;i++)e[i]=[],r[i]=[],e[i][4]=1,e[i][3]=this.y[i],e[i][2]=this.x[i],e[i][1]=this.y[i]*this.y[i],e[i][0]=this.x[i]*this.y[i],r[i][0]=-this.x[i]*this.x[i];e=new Matrix(e),r=new Matrix(r);var n=e.solve(r),s=[];s[0]=[];for(i=s[0][0]=1;i<6;i++)s[i]=[],s[i][0]=n.A[i-1][0];return this.returnEllipse(s,t)},i.prototype.ellipseGenB=function(t=-1){for(var e=[],r=[],i=0;i<this.x.length;i++)e[i]=[],r[i]=[],e[i][4]=1,e[i][3]=this.y[i],e[i][2]=this.x[i],e[i][1]=this.y[i]*this.y[i],e[i][0]=this.x[i]*this.x[i],r[i][0]=-this.x[i]*this.y[i];e=new Matrix(e),r=new Matrix(r);for(var n=e.solve(r),s=[],i=0;i<5;i++)0==i?(s[i]=[],s[i][0]=n.A[i][0]):(s[i+1]=[],s[i+1][0]=n.A[i][0]);return s[1]=[],s[1][0]=1,this.returnEllipse(s,t)},i.prototype.ellipseGenC=function(t=-1){for(var e=[],r=[],i=0;i<this.x.length;i++)e[i]=[],r[i]=[],e[i][4]=1,e[i][3]=this.y[i],e[i][2]=this.x[i],e[i][1]=this.x[i]*this.y[i],e[i][0]=this.x[i]*this.x[i],r[i][0]=-this.y[i]*this.y[i];e=new Matrix(e),r=new Matrix(r);for(var n=e.solve(r),s=[],i=0;i<5;i++)i<=1?(s[i]=[],s[i][0]=n.A[i][0]):(s[i+1]=[],s[i+1][0]=n.A[i][0]);return s[2]=[],s[2][0]=1,this.returnEllipse(s,t)},i.prototype.ellipseGenD=function(t=-1){for(var e=[],r=[],i=0;i<this.x.length;i++)e[i]=[],r[i]=[],e[i][4]=1,e[i][3]=this.y[i],e[i][2]=this.y[i]*this.y[i],e[i][1]=this.x[i]*this.y[i],e[i][0]=this.x[i]*this.x[i],r[i][0]=-this.x[i];e=new Matrix(e),r=new Matrix(r);for(var n=e.solve(r),s=[],i=0;i<5;i++)i<=2?(s[i]=[],s[i][0]=n.A[i][0]):(s[i+1]=[],s[i+1][0]=n.A[i][0]);return s[3]=[],s[3][0]=1,this.returnEllipse(s,t)},i.prototype.ellipseGenE=function(t=-1){for(var e=[],r=[],i=0;i<this.x.length;i++)e[i]=[],r[i]=[],e[i][4]=1,e[i][3]=this.x[i],e[i][2]=this.y[i]*this.y[i],e[i][1]=this.x[i]*this.y[i],e[i][0]=this.x[i]*this.x[i],r[i][0]=-this.y[i];e=new Matrix(e),r=new Matrix(r);for(var n=e.solve(r),s=[],i=0;i<5;i++)i<=3?(s[i]=[],s[i][0]=n.A[i][0]):(s[i+1]=[],s[i+1][0]=n.A[i][0]);return s[4]=[],s[4][0]=1,this.returnEllipse(s,t)},i.prototype.ellipseGenF=function(t=-1){for(var e=[],r=[],i=0;i<this.x.length;i++)e[i]=[],r[i]=[],r[i][0]=-1,e[i][4]=this.y[i],e[i][3]=this.x[i],e[i][2]=this.y[i]*e[i][4],e[i][1]=this.x[i]*this.y[i],e[i][0]=this.x[i]*e[i][3];e=new Matrix(e),r=new Matrix(r);for(var n=e.solve(r),s=[],i=0;i<5;i++)s[i]=[],s[i][0]=n.A[i][0];return s[5]=[],s[5][0]=1,this.returnEllipse(s,t)},i.prototype.returnEllipse=function(t,e=-1){var r=t[0][0],i=t[1][0],n=t[2][0],s=t[3][0],o=t[4][0],l=i*i,a=r-n,h=r+n,p=n*s,x=i*s,c=i*o,y=r*o,f=l-4*r*n,s=2*((y-x)*o+n*s*s+f*t[5][0]),a=Math.sqrt(a*a+l),l=-Math.sqrt(s*(h+a))/f,h=-Math.sqrt(s*(h-a))/f,c=(2*p-c)/f,x=(2*y-x)/f,f=0,f=0==i?n<r?0:Math.PI:Math.atan(1/i*(n-r-a));return-1!=e&&(e.x_c=c,e.y_c=x,e.a_r=l,e.b_r=h,e.theta=f),new Matrix(t)},i.runLeastSquaresTest=function(){var t=[.083488725,.972233795,.519432488,.557793421,.300510972,.529587317,.288370293,.295974099,.972950908,.562190618,.485386043,.187655207,.173117839,.401618916,.510703949,.834813425,.913974888,.358703401,.037429811,.809497463,.285912045,.153523603,.966634609,.529821905,.592251179,.710151685,.611030014,.137094865,.619995355,.185711451],e=[.154093159,.560237285,.301702746,.233999395,.319387128,.912314852,.055485191,.131389179,.584452711,.121399731,.478089423,.527552888,.30823643,.401301559,.39393612,.057959329,.429895272,.212793677,.058030451,.128383908,.069685073,.588424668,.129995286,.895030989,.310668533,.286987422,.714797546,.238023745,.842531267,.710897663],r=new i(t,e);console.log("x data"),console.log(t),console.log("y data"),console.log(e),console.log("line fit");t=r.line();t.print(5,3),console.log("parabola fit"),(t=r.parab()).print(5,3),console.log("5th degree poly fit"),(t=r.poly(5)).print(5,3),console.log("8th degree poly fit"),(t=r.poly(8)).print(5,3),console.log("Logarithmic fit"),(t=r.log()).print(5,3),console.log("3rd degree exp freq sin fit (10Hz start freq)"),(t=r.sinExpFreq(3,10,2)).print(5,3),console.log("3rd degree exp freq cos fit (10Hz start freq)"),(t=r.cosExpFreq(3,10,2)).print(5,3),console.log("3rd degree exp freq sin-cos fit (10Hz start freq)"),(t=r.sinCosExpFreq(3,10,2)).print(5,3);e=[-4,-3,-2,-1,0,1,2,3,4],r=[-1,0,-1.5,.5,1,-1,-.5,2,-1];console.log("x data"),console.log(e),console.log("y data"),console.log(r);e=new i(e,r);console.log("3rd degree linear freq sin fit"),(t=e.sinLinFreq(3)).print(5,3),console.log("3rd degree linear freq cos fit"),(t=e.cosLinFreq(3)).print(5,3),console.log("3rd degree linear freq sin-cos fit"),(t=e.sinCosLinFreq(3)).print(5,3);console.log("Exponential fit (Linear LS)");r=new i([1.006,1.666,3.418,3.605,4.562,6.166,7.331,7.642,8.745,9.971,10.924,11.702,12.802,14.339,14.901],[.853,1.625,5.326,4.168,9.873,14.529,21.579,25.018,33.839,45.783,59.037,76.58,94.795,123.343,161.893]);(t=r.expLin()).print(5,3),console.log("Power law fit (Linear LS)"),(t=r.powLin()).print(5,3),console.log("Elliptical Fits");e=new i(xElp,yElp);console.log("Ellipse with default, no return parameters (only Ax2+Bxy+Cy2+Dx+Ey+F matrix)"),(t=e.ellipseGen()).print(5,3);r={};t=e.ellipseGen(r,0),console.log("Ellipse parameters (x2 as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3),r={},t=e.ellipseGen(r,1),console.log("Ellipse parameters (xy as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3),r={},t=e.ellipseGen(r,2),console.log("Ellipse parameters (y2 as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3),r={},t=e.ellipseGen(r,3),console.log("Ellipse parameters (x as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3),r={},t=e.ellipseGen(r,4),console.log("Ellipse parameters (y as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3),r={},t=e.ellipseGen(r,5),console.log("Ellipse parameters (Const as dependent var)"),console.log("x_c: "+r.x_c+" y_c: "+r.y_c+" a_r: "+r.a_r+" b_r: "+r.b_r+" theta: "+r.theta),t.print(5,3)},i}();Matrix.__class="LeastSquares",Matrix.__interfaces=["java.lang.Cloneable","java.io.Serializable"];